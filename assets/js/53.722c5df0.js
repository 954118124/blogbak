(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{547:function(s,n,a){"use strict";a.r(n);var e=a(18),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一、简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、简介"}},[s._v("#")]),s._v(" 一、简介")]),s._v(" "),a("h3",{attrs:{id:"_1-1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-概述"}},[s._v("#")]),s._v(" 1.1 概述")]),s._v(" "),a("p",[s._v("Spring Cloud Stream 是一个用来为微服务应用构建消息驱动能力的框架。它可以基于 Spring Boot 来创建独立的、可用于生产的 Spring 应用程序。Spring Cloud Stream 为一些供应商的消息中间件产品提供了个性化的自动化配置实现，并引入了发布-订阅、消费组、分区这三个核心概念。通过使用 Spring Cloud Stream，可以有效简化开发人员对消息中间件的使用复杂度，让系统开发人员可以有更多的精力关注于核心业务逻辑的处理。但是目前 Spring Cloud Stream 只支持 RabbitMQ 和 Kafka 的自动化配置。")]),s._v(" "),a("h2",{attrs:{id:"二、快速搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、快速搭建"}},[s._v("#")]),s._v(" 二、快速搭建")]),s._v(" "),a("p",[s._v("我们通过一个简单的示例对 Spring Cloud Stream 有一个初步的认识。中间件使用 RabbitMQ，创建 spring-cloud-stream 模块。")]),s._v(" "),a("h3",{attrs:{id:"_2-1-引入依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-引入依赖"}},[s._v("#")]),s._v(" 2.1 引入依赖")]),s._v(" "),a("p",[s._v("编辑 pom.xml 文件，引入 Spring Cloud Stream 对 RabbitMQ 支持的 spring-cloud-starter-stream-rabbit 依赖，该依赖包是 Spring Cloud Stream 对 RabbitMQ 支持的封装，其中包含了对 RabbitMQ 的自动化配置等内容。")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-stream</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-rabbit</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-kafka</artifactId>\n        </dependency>\n \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"三、开发指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、开发指南"}},[s._v("#")]),s._v(" 三、开发指南")]),s._v(" "),a("h3",{attrs:{id:"_3-1-apollo-增加配置stream-yml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-apollo-增加配置stream-yml"}},[s._v("#")]),s._v(" 3.1 apollo 增加配置stream.yml")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("spring:\n  cloud:\n    stream:\n      bindings:\n       #输入通道名称,对应java代码InputInterface定义的名称\n        rabbit-mq-demo-test-input:\n          #通道主题名\n          destination: rabbit-mq-demo-test\n          contentType: application/json\n          #消费组名称, 多节点消费保证唯一\n          group: rabbit-mq-demo-test\n          #绑定的QM配置\n          binder: rabbit-test\n          consumer:\n            enable-auto-commit: false\n            auto-offset-reset: earliest\n            max-poll-records: 1000\n            concurrency: 6\n\n        rabbit-mq-demo-test-output:\n          destination: rabbit-mq-demo-test\n          contentType: application/json\n          group: \n          binder: rabbit-test\n          consumer:\n            enable-auto-commit: false\n            auto-offset-reset: earliest\n            max-poll-records: 1000\n            concurrency: 6\n            \n        demo-test-input:\n          destination: demo-test\n          contentType: application/json\n          group: demo-test\n          binder: kafka-test\n          consumer:\n            enable-auto-commit: false\n            auto-offset-reset: earliest\n            max-poll-records: 1000\n            concurrency: 6\n            \n        demo-test-output:\n          destination: demo-test\n          contentType: application/json\n          group: demo-test\n          binder: kafka-test\n          consumer:\n            enable-auto-commit: false\n            auto-offset-reset: earliest\n            max-poll-records: 1000\n            concurrency: 6\n      #默认配置, 当存在多个配置事必须配置, 否则获取不到MQ配置\n      default-binder: rabbit-test    \n      binders:\n      #RabbitMQ配置\n        rabbit-test:\n          type: rabbit\n          environment:\n            spring:\n              rabbitmq:\n                host: 192.168.1.212\n                port: 5672\n                username: guest\n                password: guest\n                virtual-host: /\n        #Kafka配置     \n        kafka-test:\n          type: kafka\n          environment:\n            spring:\n              cloud:\n                stream:\n                  kafka:\n                    binder:\n                      brokers: 10.33.110.231:9092,10.33.110.232:9092,10.33.110.233:9092\n                      auto-add-partitions: true\n                      auto-create-topics: true\n                      min-partition-count: 1\n                      replication-factor: 3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br")])]),a("h3",{attrs:{id:"_3-2-springboot项目启动类-添加注解springbootapplication-enableapolloconfig"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-springboot项目启动类-添加注解springbootapplication-enableapolloconfig"}},[s._v("#")]),s._v(" 3.2: SpringBoot项目启动类,添加注解SpringBootApplication,EnableApolloConfig")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('@EnableApolloConfig({"stream.yml"})\n@SpringBootApplication(exclude = {RabbitAutoConfiguration.class}) \npublic class PlatformDemoApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(PlatformDemoApplication.class, args);\n    }\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("屏蔽Rabbit org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: connect 错误")]),s._v(" "),a("h4",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])]),s._v(" "),a("h3",{attrs:{id:"_3-3-创建消息通道绑定的接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-创建消息通道绑定的接口"}},[s._v("#")]),s._v(" 3.3: 创建消息通道绑定的接口")]),s._v(" "),a("p",[s._v("创建 "),a("strong",[s._v("InputInterface")]),s._v(" 接口，通过 @Input 注解定义输入通道和输出通道，另外,@Input 注解都还有一个 value 属性，该属性可以用来设置消息通道的名称，")]),s._v(" "),a("p",[s._v("RabbitMQ: rabbit-mq-demo-test-input")]),s._v(" "),a("p",[s._v("Kafka: demo-test-input")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('@Component\npublic interface InputInterface {\n\n    //RabbitMQ接收者通道\n    String RABBIT_MQ_DEMO_TEST_INPUT = "rabbit-mq-demo-test-input";\n\n    //Kafka接收者通道\n    String KAFKA_DEMO_TEST_INPUT = "demo-test-input";\n\n\n    @Input(RABBIT_MQ_DEMO_TEST_INPUT)\n    SubscribableChannel rabbitMQInput();\n\n    @Input(KAFKA_DEMO_TEST_INPUT)\n    SubscribableChannel kafkaSendInput();\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("创建 "),a("strong",[s._v("OutputInterface")]),s._v("接口，通过@Output 注解定义输入通道和输出通道，另外@Output 注解都还有一个 value 属性，该属性可以用来设置消息通道的名称，")]),s._v(" "),a("p",[s._v("RabbitMQ: rabbit-mq-demo-test-output")]),s._v(" "),a("p",[s._v("Kafka: demo-test-output")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('@Component\npublic interface OutputInterface {\n\n    //RabbitMQ接收者通道\n    String RABBIT_MQ_DEMO_TEST_INPUT = "rabbit-mq-demo-test-output";\n\n    //Kafka接收者通道\n    String KAFKA_DEMO_TEST_INPUT = "demo-test-output";\n\n\n    @Output(RABBIT_MQ_DEMO_TEST_INPUT)\n    SubscribableChannel rabbitMQSendMessage();\n\n    @Output(KAFKA_DEMO_TEST_INPUT)\n    SubscribableChannel kafkaSendMessage();\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"_3-4-发送消息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-发送消息"}},[s._v("#")]),s._v(" 3.4 发送消息")]),s._v(" "),a("p",[s._v("创建测试消息实体"),a("strong",[s._v("MessageDTO")])]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("@Data\npublic class MessageDTO {\n\n    /**\n     * ID\n     */\n    private Integer id;\n    /**\n     * 编码\n     */\n    private String code;\n    /**\n     * 名称\n     */\n    private String name;\n    /**\n     * 模块名称\n     */\n    private String module;\n    /**\n     * 操作类型\n     */\n    private String operation;\n    /**\n     * 冗余字段\n     */\n    private String json;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[s._v("创建"),a("strong",[s._v("MqMessageService")]),s._v("接口以及"),a("strong",[s._v("MqServiceImpl")]),s._v("实现类")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("public interface MqMessageService {\n\n    boolean sendRabbitMqMessage(MessageDTO dto);\n\n    boolean sendKafkaMessage(MessageDTO dto);\n\n}\n@Slf4j\n@Service\n@EnableBinding(value = {OutputInterface.class})\npublic class MqMessageServiceImpl implements MqMessageService {\n\n    @Autowired\n    private OutputInterface outputInterface;\n\n    @Override\n    public boolean sendRabbitMqMessage(MessageDTO dto) {\n        Message message = MessageBuilder.withPayload(dto).build();\n        return outputInterface.rabbitMQSendMessage().send(message);\n    }\n\n    @Override\n    public boolean sendKafkaMessage(MessageDTO dto) {\n        Message message = MessageBuilder.withPayload(dto).build();\n        return outputInterface.kafkaSendMessage().send(message);\n    }\n\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h3",{attrs:{id:"_3-5-接收消息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-接收消息"}},[s._v("#")]),s._v(" 3.5 接收消息")]),s._v(" "),a("p",[s._v("创建监听器"),a("strong",[s._v("InputStreamListener")])]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('@Slf4j\n@EnableBinding(InputInterface.class)\n@Component\npublic class InputStreamListener {\n\n    @StreamListener(value = InputInterface.RABBIT_MQ_DEMO_TEST_INPUT)\n    public void showRabbitMQMessage(@Payload MessageDTO dto) {\n        log.info("showRabbitMQMessage message :[{}]", dto);\n\n    }\n    \n    @StreamListener(value = InputInterface.KAFKA_DEMO_TEST_INPUT)\n    public void showKafkaMessage(@Payload MessageDTO dto) {\n        log.info("showKafkaMessage message:{}", dto);\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h3",{attrs:{id:"_3-6-接口测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-接口测试"}},[s._v("#")]),s._v(" 3.6 接口测试")]),s._v(" "),a("p",[s._v("1.创建"),a("strong",[s._v("MQController")])]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('@Api(value = "MQController", tags = "MQ测试")\n@RequestMapping("/mqDemo")\n@RestController\n@Slf4j\npublic class MQController {\n\n    @Autowired\n    private MqMessageService mqMessageService;\n\n\n    @ApiOperation(value = "发送RabbitMQ消息", notes = "发送RabbitMQ消息")\n    @PostMapping("sendRabbitMqMessage")\n    public Result<Boolean> sendRabbitMqMessage(@Valid @RequestBody MessageDTO messageDTO) {\n        return Result.success(mqMessageService.sendRabbitMqMessage(messageDTO));\n    }\n\n    @ApiOperation(value = "发送Kafka消息", notes = "发送Kafka消息")\n    @PostMapping("sendKafkaMessage")\n    public Result<Boolean> sendKafkaMessage(@Valid @RequestBody MessageDTO messageDTO) {\n        return Result.success(mqMessageService.sendKafkaMessage(messageDTO));\n    }\n    \n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("2."),a("strong",[s._v("Postman")]),s._v("测试")]),s._v(" "),a("p",[a("strong",[s._v("RabbitMq")])]),s._v(" "),a("p",[s._v("发送接口:http://localhost:8080/demoapi/mqDemo/sendRabbitMqMessage")]),s._v(" "),a("p",[s._v("测试数据")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('{\n    "id":1,\n    "code":"code",\n    "name":"name",\n    "module":"module",\n    "operation":"INSERT",\n    "json":"发送RabbitMQ数据"\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("监听器接收RabbitMQ数据")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("c.y.p.d.m.l.InputStreamListener - showRabbitMQMessage message :[MessageDTO(id=1, code=code, name=name, module=module, operation=INSERT, json=发送RabbitMQ数据)]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("Kafka")])]),s._v(" "),a("p",[s._v("发送接口:http://localhost:8080/demoapi/mqDemo/sendKafkaMessage")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v('{\n    "id":2,\n    "code":"code",\n    "name":"name",\n    "module":"module",\n    "operation":"INSERT",\n    "json":"发送Kafka数据"\n\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("监听器接收Kafka数据")]),s._v(" "),a("div",{staticClass:"language-PlainText line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("INFO  c.y.p.d.m.l.InputStreamListener - showKafkaMessage message:MessageDTO(id=2, code=code, name=name, module=module, operation=INSERT, json=发送Kafka数据)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);