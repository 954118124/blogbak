<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>事务 | Louis&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="http://media.luoxiaofeng.cn/blog/star.png">
    <meta name="description" content="专注后端技术">
    <meta name="keywords" content="后端博客,个人技术博客,技术文档,学习,Java,mysql,ES,Oracle,K8S,jenkins,docker,jvm,spring cloud,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.daeec4d3.css" as="style"><link rel="preload" href="/assets/js/app.d7ce72ed.js" as="script"><link rel="preload" href="/assets/js/2.f39d1b19.js" as="script"><link rel="preload" href="/assets/js/36.ba98c8cd.js" as="script"><link rel="prefetch" href="/assets/js/10.5c972d7e.js"><link rel="prefetch" href="/assets/js/11.7e2a3186.js"><link rel="prefetch" href="/assets/js/12.704d47fe.js"><link rel="prefetch" href="/assets/js/13.8138b9f0.js"><link rel="prefetch" href="/assets/js/14.096585b2.js"><link rel="prefetch" href="/assets/js/15.2ea7dd45.js"><link rel="prefetch" href="/assets/js/16.617fa79c.js"><link rel="prefetch" href="/assets/js/17.baa7f295.js"><link rel="prefetch" href="/assets/js/18.bc6e3f2a.js"><link rel="prefetch" href="/assets/js/19.c60bf3bf.js"><link rel="prefetch" href="/assets/js/20.99f2b929.js"><link rel="prefetch" href="/assets/js/21.a4aea91a.js"><link rel="prefetch" href="/assets/js/22.eeb571c8.js"><link rel="prefetch" href="/assets/js/23.78401243.js"><link rel="prefetch" href="/assets/js/24.19799dbf.js"><link rel="prefetch" href="/assets/js/25.37a89fcb.js"><link rel="prefetch" href="/assets/js/26.e9f6391c.js"><link rel="prefetch" href="/assets/js/27.8ba3c7f4.js"><link rel="prefetch" href="/assets/js/28.56a598e1.js"><link rel="prefetch" href="/assets/js/29.ce88bfe3.js"><link rel="prefetch" href="/assets/js/3.347829c2.js"><link rel="prefetch" href="/assets/js/30.19bca574.js"><link rel="prefetch" href="/assets/js/31.bbb78c9c.js"><link rel="prefetch" href="/assets/js/32.bcac7637.js"><link rel="prefetch" href="/assets/js/33.4a6bb74c.js"><link rel="prefetch" href="/assets/js/34.a5175bc0.js"><link rel="prefetch" href="/assets/js/35.df93bce0.js"><link rel="prefetch" href="/assets/js/37.15426157.js"><link rel="prefetch" href="/assets/js/38.7dfdb586.js"><link rel="prefetch" href="/assets/js/39.799ea50e.js"><link rel="prefetch" href="/assets/js/4.bd92418e.js"><link rel="prefetch" href="/assets/js/40.7d304a58.js"><link rel="prefetch" href="/assets/js/41.4f267901.js"><link rel="prefetch" href="/assets/js/42.6d8298d3.js"><link rel="prefetch" href="/assets/js/43.0283af03.js"><link rel="prefetch" href="/assets/js/44.579cf258.js"><link rel="prefetch" href="/assets/js/45.f32e2a7c.js"><link rel="prefetch" href="/assets/js/46.880f4527.js"><link rel="prefetch" href="/assets/js/47.3132fd72.js"><link rel="prefetch" href="/assets/js/48.1ab83cae.js"><link rel="prefetch" href="/assets/js/49.17233d6b.js"><link rel="prefetch" href="/assets/js/5.2d40d187.js"><link rel="prefetch" href="/assets/js/50.715c8235.js"><link rel="prefetch" href="/assets/js/51.60499077.js"><link rel="prefetch" href="/assets/js/52.985814b9.js"><link rel="prefetch" href="/assets/js/53.cdfe6fbd.js"><link rel="prefetch" href="/assets/js/54.2f036c47.js"><link rel="prefetch" href="/assets/js/55.ddaed78c.js"><link rel="prefetch" href="/assets/js/56.294bd3d7.js"><link rel="prefetch" href="/assets/js/57.a2e4f259.js"><link rel="prefetch" href="/assets/js/58.ed113fdb.js"><link rel="prefetch" href="/assets/js/59.e86a8e3f.js"><link rel="prefetch" href="/assets/js/6.302fb005.js"><link rel="prefetch" href="/assets/js/60.96d5ed6d.js"><link rel="prefetch" href="/assets/js/61.8929ac7f.js"><link rel="prefetch" href="/assets/js/62.325f88d8.js"><link rel="prefetch" href="/assets/js/63.78255037.js"><link rel="prefetch" href="/assets/js/64.a016537e.js"><link rel="prefetch" href="/assets/js/65.cabb3053.js"><link rel="prefetch" href="/assets/js/66.a23325f5.js"><link rel="prefetch" href="/assets/js/67.af383ab9.js"><link rel="prefetch" href="/assets/js/68.3abd0620.js"><link rel="prefetch" href="/assets/js/69.c96f585d.js"><link rel="prefetch" href="/assets/js/7.a6e5a0c4.js"><link rel="prefetch" href="/assets/js/70.40bd8334.js"><link rel="prefetch" href="/assets/js/71.65ca6ebf.js"><link rel="prefetch" href="/assets/js/72.b3df0ff9.js"><link rel="prefetch" href="/assets/js/73.fb5cd2d0.js"><link rel="prefetch" href="/assets/js/74.5da3ef52.js"><link rel="prefetch" href="/assets/js/75.fcee8cb7.js"><link rel="prefetch" href="/assets/js/76.31fcdf4b.js"><link rel="prefetch" href="/assets/js/77.7ffbc0b3.js"><link rel="prefetch" href="/assets/js/78.c6d54f3c.js"><link rel="prefetch" href="/assets/js/79.cd6e1a7c.js"><link rel="prefetch" href="/assets/js/8.40a90d8d.js"><link rel="prefetch" href="/assets/js/80.aef9fad9.js"><link rel="prefetch" href="/assets/js/81.87a224d2.js"><link rel="prefetch" href="/assets/js/82.40c4ec64.js"><link rel="prefetch" href="/assets/js/83.0f5718dc.js"><link rel="prefetch" href="/assets/js/84.0a3fb58d.js"><link rel="prefetch" href="/assets/js/85.2d2a1e21.js"><link rel="prefetch" href="/assets/js/86.37906477.js"><link rel="prefetch" href="/assets/js/87.1e123481.js"><link rel="prefetch" href="/assets/js/88.b1284090.js"><link rel="prefetch" href="/assets/js/89.352f857e.js"><link rel="prefetch" href="/assets/js/9.854ec9c5.js"><link rel="prefetch" href="/assets/js/90.82803ff4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.daeec4d3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="http://media.luoxiaofeng.cn/blog/star.png" alt="Louis's Blog" class="logo"> <span class="site-name can-hide">Louis's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/8611ff/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/pages/f811c1/" class="nav-link">技术应用</a></div><div class="nav-item"><a href="/pages/bcce0d/" class="nav-link">流程规范</a></div><div class="nav-item"><a href="/friends/" class="nav-link">更多</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="http://media.luoxiaofeng.cn/blog/lxf.jpeg"> <div class="blogger-info"><h3>Louis</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/8611ff/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/pages/f811c1/" class="nav-link">技术应用</a></div><div class="nav-item"><a href="/pages/bcce0d/" class="nav-link">流程规范</a></div><div class="nav-item"><a href="/friends/" class="nav-link">更多</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>消息中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>持久化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/b7bb53/" class="sidebar-link">数据库设计三大范式</a></li><li><a href="/pages/a37446/" class="sidebar-link">执行计划Explain</a></li><li><a href="/pages/391bcd/" class="sidebar-link">索引</a></li><li><a href="/pages/904632/" aria-current="page" class="active sidebar-link">事务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/904632/#_1-什么是事务" class="sidebar-link">1 什么是事务？</a></li><li class="sidebar-sub-header level2"><a href="/pages/904632/#_2-事务有哪些特性" class="sidebar-link">2 事务有哪些特性？</a></li><li class="sidebar-sub-header level2"><a href="/pages/904632/#_3-innodb怎么实现事务" class="sidebar-link">3 innodb怎么实现事务</a></li><li class="sidebar-sub-header level2"><a href="/pages/904632/#_4-并发事务带来的问题" class="sidebar-link">4 并发事务带来的问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/904632/#_4-1-脏读-dirty-read" class="sidebar-link">4.1 脏读（Dirty read）</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_4-2-不可重复读-nonrepeatable-read" class="sidebar-link">4.2 不可重复读（Nonrepeatable read）</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_4-3-幻影读-phantom-reads" class="sidebar-link">4.3 幻影读（Phantom reads）</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_4-4-不可重复度和幻读区别" class="sidebar-link">4.4 不可重复度和幻读区别</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/904632/#_5-事务隔离级别" class="sidebar-link">5 事务隔离级别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/904632/#_5-1-read-uncommitted-读取未提交" class="sidebar-link">5.1 READ-UNCOMMITTED(读取未提交)</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_5-2-read-committed-读取已提交" class="sidebar-link">5.2 READ-COMMITTED(读取已提交)</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_5-3-repeatable-read-可重复读" class="sidebar-link">5.3 REPEATABLE-READ(可重复读)</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_5-4-serializable-串行化" class="sidebar-link">5.4 SERIALIZABLE(串行化)</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_5-5-数据库默认隔离级别" class="sidebar-link">5.5 数据库默认隔离级别</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/904632/#_6-spring-事务中的隔离级别" class="sidebar-link">6 Spring 事务中的隔离级别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/904632/#_6-1-isolation-default" class="sidebar-link">6.1 ISOLATION_DEFAULT</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_6-2-isolation-read-uncommitted" class="sidebar-link">6.2 ISOLATIONREADUNCOMMITTED</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_6-3-isolation-read-committed" class="sidebar-link">6.3 ISOLATIONREADCOMMITTED</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_6-4-isolation-repeatable-read" class="sidebar-link">6.4 ISOLATIONREPEATABLEREAD</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_6-5-isolation-serializable" class="sidebar-link">6.5 ISOLATION_SERIALIZABLE</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/904632/#_7-spring事务的7种传播行为" class="sidebar-link">7 Spring事务的7种传播行为</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/904632/#_7-1-保证同一个事务中" class="sidebar-link">7.1 保证同一个事务中</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#_1-propagation-required" class="sidebar-link">1 PROPAGATION_REQUIRED</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#_2-propagation-supports" class="sidebar-link">2 PROPAGATION_SUPPORTS</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#_3-propagation-mandatory" class="sidebar-link">3 PROPAGATION_MANDATORY</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_7-1-保证没有在同一个事务中" class="sidebar-link">7.1 保证没有在同一个事务中</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#propagation-requires-new" class="sidebar-link">PROPAGATIONREQUIRESNEW</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#_5-propagation-not-supported" class="sidebar-link">5.PROPAGATIONNOTSUPPORTED</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#_6-propagation-never" class="sidebar-link">6.PROPAGATION_NEVER</a></li><li class="sidebar-sub-header level4"><a href="/pages/904632/#_7-propagation-nested" class="sidebar-link">7.PROPAGATION_NESTED</a></li><li class="sidebar-sub-header level3"><a href="/pages/904632/#_7-2-传播级别不生效原因" class="sidebar-link">7.2 传播级别不生效原因？</a></li></ul></li></ul></li><li><a href="/pages/d9091c/" class="sidebar-link">数据库锁</a></li><li><a href="/pages/649d86/" class="sidebar-link">Elasticsearch 杂记</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>系统架构</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" title="分类" data-v-1baff76c>学习笔记</a></li><li data-v-1baff76c><a href="/categories/?category=%E6%8C%81%E4%B9%85%E5%8C%96" title="分类" data-v-1baff76c>持久化</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://github.com/954118124" target="_blank" title="作者" class="beLink" data-v-1baff76c>luoxiaofeng</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2022-05-07</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">事务<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="_1-什么是事务"><a href="#_1-什么是事务" class="header-anchor">#</a> 1 什么是事务？</h2> <p>事务逻辑上的一组操作，组成这组操作的各个逻辑单元,要么一起成功,要么一起失败。</p> <h2 id="_2-事务有哪些特性"><a href="#_2-事务有哪些特性" class="header-anchor">#</a> 2 事务有哪些特性？</h2> <p><strong>事务的特性（ACID）</strong></p> <p><strong>原子性（atomicity）:</strong> 事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用;</p> <p><strong>一致性（consistency）:</strong> 执行事务前后，数据保持一致，多个事务对同一个数据读取的结果是相同的;</p> <p><strong>隔离性（isolation）:</strong> 并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的;</p> <p><strong>持久性（durability）:</strong> 事务一旦结束，数据就持久到数据库。</p> <h2 id="_3-innodb怎么实现事务"><a href="#_3-innodb怎么实现事务" class="header-anchor">#</a> 3 innodb怎么实现事务</h2> <p>ACD三个特性是通过Redo log（重做日志）和Undo log实现的。 而隔离性是通过锁来实现的。</p> <h2 id="_4-并发事务带来的问题"><a href="#_4-并发事务带来的问题" class="header-anchor">#</a> 4 并发事务带来的问题</h2> <h3 id="_4-1-脏读-dirty-read"><a href="#_4-1-脏读-dirty-read" class="header-anchor">#</a> 4.1 脏读（Dirty read）</h3> <p>脏读发生在一个事务读取了被另一个事务改写但尚未提交的数据时。如果这些改变在稍后被回滚了，那么第一个事务读取的数据就会是无效的。</p> <h3 id="_4-2-不可重复读-nonrepeatable-read"><a href="#_4-2-不可重复读-nonrepeatable-read" class="header-anchor">#</a> 4.2 不可重复读（Nonrepeatable read）</h3> <p>不可重复读发生在一个事务执行相同的查询两次或两次以上，但每次查询结果都不相同时。这通常是由于另一个并发事务在两次查询之间更新了数据。</p> <h3 id="_4-3-幻影读-phantom-reads"><a href="#_4-3-幻影读-phantom-reads" class="header-anchor">#</a> 4.3 幻影读（Phantom reads）</h3> <p>幻影读和不可重复读相似。当一个事务（T1）读取几行记录后，另一个并发事务（T2）插入了一些记录时，幻影读就发生了。在后来的查询中，第一个事务（T1）就会发现一些原来没有的额外记录。</p> <h3 id="_4-4-不可重复度和幻读区别"><a href="#_4-4-不可重复度和幻读区别" class="header-anchor">#</a> 4.4 不可重复度和幻读区别</h3> <p>不可重复读的重点是修改，幻读的重点在于新增或者删除。</p> <h2 id="_5-事务隔离级别"><a href="#_5-事务隔离级别" class="header-anchor">#</a> 5 事务隔离级别</h2> <h3 id="_5-1-read-uncommitted-读取未提交"><a href="#_5-1-read-uncommitted-读取未提交" class="header-anchor">#</a> 5.1 READ-UNCOMMITTED(读取未提交)</h3> <p>最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或不可重复读</p> <h3 id="_5-2-read-committed-读取已提交"><a href="#_5-2-read-committed-读取已提交" class="header-anchor">#</a> 5.2 READ-COMMITTED(读取已提交)</h3> <p>允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或不可重复读仍有可能发生</p> <h3 id="_5-3-repeatable-read-可重复读"><a href="#_5-3-repeatable-read-可重复读" class="header-anchor">#</a> 5.3 REPEATABLE-READ(可重复读)</h3> <p>对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止脏读和不可重复读，但幻读仍有可能发生。</p> <h3 id="_5-4-serializable-串行化"><a href="#_5-4-serializable-串行化" class="header-anchor">#</a> 5.4 SERIALIZABLE(串行化)</h3> <p>最高的隔离级别，完全服从ACID的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。</p> <h3 id="_5-5-数据库默认隔离级别"><a href="#_5-5-数据库默认隔离级别" class="header-anchor">#</a> 5.5 数据库默认隔离级别</h3> <p>MySQL InnoDB 存储引擎的默认支持的隔离级别是：REPEATABLE-READ（可重读）</p> <p>Oracle 默认：READ-COMMITTED（读已提交）</p> <img src="http://media.luoxiaofeng.cn/blog/img/a94967fbc3b08e972fee8687d3a96146.png" width="70%" class="imgcss"> <h2 id="_6-spring-事务中的隔离级别"><a href="#_6-spring-事务中的隔离级别" class="header-anchor">#</a> 6 Spring 事务中的隔离级别</h2> <p><strong>TransactionDefinition 接口中定义了五个表示隔离级别的常量:</strong></p> <p>TransactionDefinition.ISOLATION_DEFAULT</p> <p>TransactionDefinition.ISOLATION_READ_UNCOMMITTED</p> <p>TransactionDefinition.ISOLATION_READ_COMMITTED</p> <p>TransactionDefinition.ISOLATION_REPEATABLE_READ</p> <p>TransactionDefinition.ISOLATION_SERIALIZABLE</p> <h3 id="_6-1-isolation-default"><a href="#_6-1-isolation-default" class="header-anchor">#</a> 6.1 ISOLATION_DEFAULT</h3> <p>使用后端数据库默认的隔离级别。</p> <p>Mysql 默认采用的 REPEATABLE_READ隔离级别。Oracle 默认采用的 READ_COMMITTED隔离级别。</p> <h3 id="_6-2-isolation-read-uncommitted"><a href="#_6-2-isolation-read-uncommitted" class="header-anchor">#</a> 6.2 ISOLATION_READ_UNCOMMITTED</h3> <p>最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或不可重复读。</p> <h3 id="_6-3-isolation-read-committed"><a href="#_6-3-isolation-read-committed" class="header-anchor">#</a> 6.3 ISOLATION_READ_COMMITTED</h3> <p>允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或不可重复读仍有可能发生。</p> <h3 id="_6-4-isolation-repeatable-read"><a href="#_6-4-isolation-repeatable-read" class="header-anchor">#</a> 6.4 ISOLATION_REPEATABLE_READ</h3> <p>对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止脏读和不可重复读，但幻读仍有可能发生。</p> <h3 id="_6-5-isolation-serializable"><a href="#_6-5-isolation-serializable" class="header-anchor">#</a> 6.5 ISOLATION_SERIALIZABLE</h3> <p>最高的隔离级别，完全服从ACID的隔离级别。</p> <p>所有事务依次逐个执行，事务之间不产生干扰，也就是说该级别可以防止脏读、不可重复读以及幻读。</p> <p>但是这将严重影响程序的性能。通常情况下也不会用到该级别。</p> <h2 id="_7-spring事务的7种传播行为"><a href="#_7-spring事务的7种传播行为" class="header-anchor">#</a> 7 Spring事务的7种传播行为</h2> <h3 id="_7-1-保证同一个事务中"><a href="#_7-1-保证同一个事务中" class="header-anchor">#</a> 7.1 保证同一个事务中</h3> <h4 id="_1-propagation-required"><a href="#_1-propagation-required" class="header-anchor">#</a> 1 PROPAGATION_REQUIRED</h4> <p><strong>如果存在一个事务则支持当前事务，如果不存在就新建一个(默认)</strong></p> <img src="http://media.luoxiaofeng.cn/blog/img/5ebd355004cffff75d16dcbbad70ff50.png" width="70%" class="imgcss"> <h4 id="_2-propagation-supports"><a href="#_2-propagation-supports" class="header-anchor">#</a> 2 PROPAGATION_SUPPORTS</h4> <p><strong>如果存在一个事务则支持当前事务，如果不存在，就不使用事务</strong></p> <p><strong><img src="http://media.luoxiaofeng.cn/blog/img/8739e831fd7c045572d57af1727a58a9.png" width="70%" class="imgcss"></strong></p> <h4 id="_3-propagation-mandatory"><a href="#_3-propagation-mandatory" class="header-anchor">#</a> 3 PROPAGATION_MANDATORY</h4> <p><strong>如果存在一个事务则支持当前事务，如果不存在，抛出异常</strong></p> <p><strong><img src="http://media.luoxiaofeng.cn/blog/img/e8b9cf464c845d1e6789e1d9fa7990f8.png" width="70%" class="imgcss"></strong></p> <h3 id="_7-1-保证没有在同一个事务中"><a href="#_7-1-保证没有在同一个事务中" class="header-anchor">#</a> 7.1 保证没有在同一个事务中</h3> <h4 id="propagation-requires-new"><a href="#propagation-requires-new" class="header-anchor">#</a> PROPAGATION_REQUIRES_NEW</h4> <p><strong>如果有事务存在，挂起当前事务，创建一个新的事务</strong></p> <p><strong><img src="http://media.luoxiaofeng.cn/blog/img/62b28f87dbe5152367d921c6389a53c9.png" width="70%" class="imgcss"></strong></p> <h4 id="_5-propagation-not-supported"><a href="#_5-propagation-not-supported" class="header-anchor">#</a> 5.PROPAGATION_NOT_SUPPORTED</h4> <p><strong>以非事务方式运行，如果有事务存在，挂起当前事务</strong></p> <p><strong><img src="http://media.luoxiaofeng.cn/blog/img/0eb5d553d14fb2587cb1d76b6d5f99a9.png" width="70%" class="imgcss"></strong></p> <h4 id="_6-propagation-never"><a href="#_6-propagation-never" class="header-anchor">#</a> 6.PROPAGATION_NEVER</h4> <p><strong>以非事务方式运行，如果有事务存在，抛出异常</strong></p> <h4 id="_7-propagation-nested"><a href="#_7-propagation-nested" class="header-anchor">#</a> 7.PROPAGATION_NESTED</h4> <p><strong>如果当前事务存在，则嵌套事务执行</strong></p> <img src="http://media.luoxiaofeng.cn/blog/img/5beb9270fd8429f96118093e23a9f289.png" width="70%" class="imgcss"> <h3 id="_7-2-传播级别不生效原因"><a href="#_7-2-传播级别不生效原因" class="header-anchor">#</a> 7.2 传播级别不生效原因？</h3> <img src="http://media.luoxiaofeng.cn/blog/img/5825e61f42435a62cbc1282493e92da0.png" width="70%" class="imgcss"> <p>必须用注入的实例（代理类实例，有代理事务逻辑处理），否则只是普通类实例会导致事务代码不生效。</p> <p>可以类自己注入自己实例。</p></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E6%95%B0%E6%8D%AE%E5%BA%93" title="标签">#数据库</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/19/2022, 9:50:28 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/391bcd/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">索引</div></a> <a href="/pages/d9091c/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">数据库锁</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/391bcd/" class="prev">索引</a></span> <span class="next"><a href="/pages/d9091c/">数据库锁</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/c177c7/"><div>
            MySQL安装
            <!----></div></a> <span class="date">05-19</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/182790/"><div>
            Kafka Manager安装
            <!----></div></a> <span class="date">05-17</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/b4a369/"><div>
            Kafka集群搭建
            <!----></div></a> <span class="date">05-16</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Louis | <a href="https://beian.miit.gov.cn" target="_blank">粤ICP备2022060093号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.d7ce72ed.js" defer></script><script src="/assets/js/2.f39d1b19.js" defer></script><script src="/assets/js/36.ba98c8cd.js" defer></script>
  </body>
</html>
